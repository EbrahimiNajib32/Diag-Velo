{% extends 'base.html.twig' %}

{% block body %}
    <div class="fixed top-0 left-0">
        <img src="{{ asset('images/EBNtrans.png') }}" alt="EBN Logo">
    </div>
    <div class="fixed top-0 right-0">
        <img src="{{ asset('images/LCDRRblanc.png') }}" alt="LCDRLR Logo">
    </div>
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold text-center text-black mb-6">Liste des vélos</h1>

        <div class="relative overflow-x shadow-md sm:rounded-lg">
            <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                <tr>
                    <th scope="col" class="px-6 py-3">Numéro de série</th>
                    <th scope="col" class="px-6 py-3">Référence recyclerie</th>
                    <th scope="col" class="px-6 py-3">Marque</th>
                    <th scope="col" class="px-6 py-3">Couleur</th>
                    <th scope="col" class="px-6 py-3">
                        Type
                        <div style="position: relative; display: inline-block;">
                            <button onclick="toggleDropdown('dropdownType')" style="background: none; border: none; cursor: pointer;">▼</button>
                            <div id="dropdownType" class="dropdown-content" style="display: none; position: absolute; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1;">
                                {% for type in ['All', 'BMX', 'Course', 'Gravel', 'Pliable', 'Ville', 'VTC', 'VTT', 'Autre'] %}
                                    <a href="#" onclick="filterRows('type', '{{ type == 'All' ? '' : type }}')" style="color: black; padding: 12px 16px; text-decoration: none; display: block;" onmouseover="hover(this, true)" onmouseout="hover(this, false)">{{ type }}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </th>
                    <th scope="col" class="px-6 py-3">
                        Public
                        <div style="position: relative; display: inline-block;">
                            <button onclick="toggleDropdown('dropdownPublic')" style="background: none; border: none; cursor: pointer;">▼</button>
                            <div id="dropdownPublic" class="dropdown-content" style="display: none; position: absolute; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1;">
                                {% for public in ['All', 'Femme', 'Homme', 'Enfant', 'Unisexe'] %}
                                    <a href="#" onclick="filterRows('public', '{{ public == 'All' ? '' : public }}')" style="color: black; padding: 12px 16px; text-decoration: none; display: block;" onmouseover="hover(this, true)" onmouseout="hover(this, false)">{{ public }}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </th>
                    <th scope="col" class="px-6 py-3">Date de Réception</th>
                    <th scope="col" class="px-6 py-3">Date de vente</th>
                    <th scope="col" class="px-6 py-3">Date de destruction</th>
                </tr>
                </thead>
                <tbody>
                {% for velo in pagination %}
                    <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700" data-type="{{ velo.type }}" data-public="{{ velo.public }}">
                        <td class="px-6 py-4">{{ velo.numero_de_serie }}</td>
                        <td class="px-6 py-4">{{ velo.ref_recyclerie }}</td>
                        <td class="px-6 py-4">{{ velo.marque }}</td>
                        <td class="px-6 py-4">{{ velo.couleur }}</td>
                        <td class="px-6 py-4">{{ velo.type }}</td>
                        <td class="px-6 py-4">{{ velo.public }}</td>
                        <td class="px-6 py-4">{{ velo.date_de_reception|date('d/m/Y') }}</td>
                        <td class="px-6 py-4">{{ velo.date_de_vente|date('d/m/Y') }}</td>
                        <td class="px-6 py-4">{{ velo.date_destruction|date('d/m/Y') }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="pagination mx-auto justify-center">
            {{ knp_pagination_render(pagination) }}
        </div>
    </div>

    <script>
        function toggleDropdown(dropdownId) {
            var dropdown = document.getElementById(dropdownId);
            dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        }

        function filterRows(attribute, value) {
            const rows = document.querySelectorAll("tbody tr");
            rows.forEach(row => {
                const attrValue = row.getAttribute('data-' + attribute);
                row.style.display = value === "" || attrValue === value ? "" : "none";
            });
            document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                dropdown.style.display = 'none';
            });
        }

        function hover(element, isHovering) {
            if (isHovering) {
                element.style.backgroundColor = '#e0e0e0'; // Light grey background on hover
            } else {
                element.style.backgroundColor = '#f9f9f9'; // Original background color
            }
        }
    </script>
{% endblock %}
