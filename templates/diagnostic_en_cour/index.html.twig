{% extends 'base.html.twig' %}

{% block body %}

    {% for message in app.flashes('success') %}
        <div class="fixed top-5 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-4 flex items-center gap-3 slide-in" id="flash-message">
            <div class="text-green-500">
                <i class="bi bi-check-circle-fill text-green-500 text-xl"></i>
            </div>
            <div>
                <p class="text-sm font-semibold text-gray-800">{{ message }}</p>
            </div>
            <button
                type="button"
                class="text-gray-400 hover:bg-gray-200 hover:text-gray-900 rounded-lg p-1.5 ml-auto inline-flex items-center"
                onclick="hideFlashMessage()"
            >
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
    {% endfor %}

    <style>
        /* Animation Slide-In */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        /* Animation Slide-Out */
        @keyframes slideOut {
            from {
                transform: translateX(0);
            }
            to {
                transform: translateX(100%);
            }
        }

        /* Classe d'animation */
        .slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }

        .slide-out {
            animation: slideOut 0.5s ease-in forwards;
        }



    </style>

    <header class="relative w-full top-0 left-0 flex justify-between items-center">
        <div id="headerLogoTissebands">
            <img src="{{ asset('images/EBNtrans.png') }}" alt="EBN Logo" class="size-40">
        </div>

        <div id="headerLogoCite">
            <img src="{{ asset('images/nouveau log 1.png') }}" alt="LCDRLR Logo" class="">
        </div>
    </header>

    <main>

        <div class="container mx-auto">

            <div class="container mx-auto mb-4">
                <h1 class="text-2xl font-bold text-black text-center"><i class="fas fa-tasks mr-2"></i> Diagnostic</h1>
                <p class="text-gray-700 font-semibold text-center">{{lieu.nomType}} {{lieu.nom}} à {{lieu.ville}}</p>
            </div>

            <nav class="py-3 px-4 container mx-auto flex justify-center mb-4">
                <ol class="breadcrumb flex items-center space-x-4">
                    <li class="breadcrumb-item font-bold flex items-center">
                        <a href="{{ path('app_accueil') }}" class="text-blue-500 hover:text-blue-600 font-bold flex items-center hover:underline">
                            <i class="fas fa-home mr-2"></i> Accueil
                        </a>
                    </li>
                    <li><i class="fas fa-angle-right text-gray-400"></i></li>
                    <li class="breadcrumb-item font-bold flex items-center">
                        <a href="{{ path('app_accueil', { 'modal': 'open' }) }}" class="text-blue-500 hover:text-blue-600 font-bold flex items-center hover:underline">
                            <i class="fas fa-map-marker-alt mr-2"></i> Lieu
                        </a>
                    </li>
                    <li><i class="fas fa-angle-right text-gray-400"></i></li>
                    <li class="breadcrumb-item text-black font-bold flex items-center">
                        Créer/Reprendre diagnostic
                    </li>
                </ol>
            </nav>


            <div class="flex justify-center mb-4">
                <a href="/velo/all" class="bg-teal-500 hover:bg-green-400 text-white rounded-lg px-4 py-2 text-sm shadow transition-colors duration-200 w-auto inline-flex items-center justify-center">
                    <i class="bi bi-plus text-lg mr-1"></i>
                    Créer un diagnostic
                </a>

            </div>
            <h1 class="text-2xl font-bold text-center text-black mb-6">Diagnostics en cours</h1>
            <table class="max-w-3xl mx-auto text-center border-2 border-gray-300 rounded-lg border-separate">
                <thead class="bg-gray-200">
                <tr class=" text-black">
                    <th class="px-2 py-2">Reference<i class="ml-1 bi bi-arrow-down-up"></i></th>
                    <th class="px-2 py-2">Marque<i class="ml-1 bi bi-arrow-down-up"></i></th>
                    <th class="px-2 py-2">Type<i class="ml-1 bi bi-arrow-down-up"></i></th>
                    <th class="px-2 py-2">Couleur<i class="ml-1 bi bi-arrow-down-up"></i></th>
                    <th class="px-2 py-2">Date d'enregistrement <i class="ml-1 bi bi-arrow-down-up"></i></th>
                    <th class="px-2 py-2"></th>
                </tr>
                </thead>
                <tbody>
                {% for item in filteredDiagnostics %}
                    <tr class="border">
                        <td class="px-4 py-2 border-r border-b">{{ item.veloDetails.refRecyclerie }}</td>
                        <td class="px-4 py-2 border-r border-b">{{ item.veloDetails.marque }}</td>
                        <td class="px-4 py-2 border-r border-b">{{ item.veloDetails.type }}</td>
                        <td class="px-4 py-2 border-r border-b">{{ item.veloDetails.couleur }}</td>
                        <td class="px-4 py-2 border-r border-b">{{ item.veloDetails.dateDeEnregistrement }}</td>
                        <td class="px-4 py-2 ">
                            <a href="{{ path('reprendre_Multidiagnostic', {'id': item.diagnostic.id}) }}" class="py-2 px-4 bg-teal-500 text-white font-semibold rounded hover:bg-teal-600 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50">
                                Continuer
                            </a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

    </main>

    <footer class="fixed bottom-0 w-full bg-white">
        <div class="flex justify-center content-center">
            <img src="{{ asset('images/nouveau log 1.png') }}" alt="LCDRLR Logo" class="">
        </div>
    </footer>

    <script>
        function hideFlashMessage() {
            const flashMessage = document.getElementById('flash-message');
            if (flashMessage) {
                flashMessage.classList.remove('slide-in');
                flashMessage.classList.add('slide-out');

                setTimeout(() => {
                    flashMessage.remove();
                }, 500);
            }
        }

        setTimeout(() => {
            hideFlashMessage();
        }, 5000);
    </script>
{% endblock %}
